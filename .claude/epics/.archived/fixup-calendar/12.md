---
name: Fix mock binding initialization timing
status: closed
created: 2026-02-01T14:36:29Z
updated: 2026-02-01T14:42:38Z
github: https://github.com/rknuus/Bearing/issues/12
depends_on: []
parallel: false
conflicts_with: []
---

# Task: Fix mock binding initialization timing

## Description

Move the `initMockBindings()` call from App.svelte's `onMount` callback to module-level execution. This ensures mock Wails bindings are available before any child component's `onMount` runs, fixing the race condition that causes CalendarView to be stuck on "Loading calendar...".

## Acceptance Criteria

- [ ] `initMockBindings()` is called at module load time, not in `onMount`
- [ ] Calendar view loads successfully in browser mode (`make frontend-dev`)
- [ ] No console errors about "Wails bindings not available" in browser mode
- [ ] Wails mode (`make dev`) still works correctly (mocks should not initialize when real bindings exist)

## Technical Details

### Current Code (App.svelte lines 234-238)
```typescript
onMount(() => {
  if (!isWailsRuntime()) {
    initMockBindings();
    console.log('[App] Running in browser mode with mock Wails bindings');
  }
  // ...
});
```

### Fix
Move the mock initialization outside `onMount` to execute at module load:
```typescript
// At module level (top of <script> block)
if (!isWailsRuntime()) {
  initMockBindings();
  console.log('[App] Running in browser mode with mock Wails bindings');
}
```

### Files Affected
- `frontend/src/App.svelte` - Move initMockBindings call

## Dependencies

- [ ] None

## Effort Estimate

- Size: XS
- Hours: 0.5
- Parallel: false (this is the core fix)

## Definition of Done

- [ ] Code change implemented
- [ ] Calendar loads in browser mode
- [ ] OKR view still works
- [ ] EisenKan view still works
- [ ] No console errors
