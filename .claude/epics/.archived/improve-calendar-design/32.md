---
name: Update edit dialog and save logic for text field
status: closed
created: 2026-02-06T14:56:53Z
updated: 2026-02-06T15:07:02Z
github: https://github.com/rknuus/Bearing/issues/32
depends_on: [31]
parallel: false
conflicts_with: [30, 31]
---

# Task: Update edit dialog and save logic for text field

## Description

Update the existing modal edit dialog to support the new `text` field. Replace the notes textarea with a single-line text input. Update the save/load logic to persist the `text` field through `SaveDayFocus`. Use full month names in the dialog title.

## Acceptance Criteria

- [ ] Dialog shows a text input (`<input type="text">`) labeled "Text" instead of the notes textarea
- [ ] Dialog title uses full month name (e.g., "January 15, 2026" not "Jan 15, 2026")
- [ ] Theme dropdown remains unchanged
- [ ] `editText` state variable replaces `editNotes` (or repurpose `editNotes` → `editText`)
- [ ] Clicking a day cell populates the dialog with existing `text` value from `DayFocus`
- [ ] Saving persists `text` field via `SaveDayFocus`
- [ ] Clear logic: when both theme and text are empty, calls `ClearDayFocus`
- [ ] Cancel closes dialog without saving
- [ ] Escape key and clicking overlay close dialog

## Technical Details

**State changes:**
```typescript
// Replace:
let editNotes = $state('');
// With:
let editText = $state('');
```

**handleDayClick update:**
```typescript
function handleDayClick(month: number, day: number) {
  // ...
  editText = focus?.text ?? '';
}
```

**saveDayFocus update:**
```typescript
const dayFocus: DayFocus = {
  date: editingDay.date,
  themeId: editThemeId,
  notes: '',  // preserve empty or keep existing
  text: editText
};
```

**Dialog template change:**
```svelte
<!-- Replace textarea with input -->
<div class="form-group">
  <label for="text-input">Text</label>
  <input
    id="text-input"
    type="text"
    bind:value={editText}
    placeholder="Add text for this day..."
  />
</div>
```

**Full month names for dialog title:**
```typescript
const fullMonthNames = [
  'January', 'February', 'March', 'April', 'May', 'June',
  'July', 'August', 'September', 'October', 'November', 'December'
];
// Dialog title: `${fullMonthNames[editingDay.month]} ${editingDay.day}, ${year}`
```
(This array is likely already added in Task #30 for headers — reuse it.)

**Files to modify:**
- `frontend/src/views/CalendarView.svelte` — Script (state, handlers) and template (dialog markup)

## Dependencies

- [ ] Task #31 — Cell rendering must be in place so clicking cells triggers the dialog correctly

## Effort Estimate

- Size: S
- Hours: 0.5
- Parallel: false
