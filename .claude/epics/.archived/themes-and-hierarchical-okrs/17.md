---
name: Recursive data model and ID generation
status: closed
created: 2026-02-06T10:11:45Z
updated: 2026-02-06T10:17:09Z
github: https://github.com/rknuus/Bearing/issues/17
depends_on: []
parallel: false
conflicts_with: []
---

# Recursive data model and ID generation

## Description

Add support for hierarchical (nested) objectives by extending the `Objective` struct with a recursive `Objectives []Objective` field. Update the ID generation logic in `ensureThemeIDs()` to walk child objectives recursively, producing hierarchical IDs such as `THEME-01.OKR-01.OKR-01` for nested objectives and `THEME-01.OKR-01.KR-01` for key results at any depth. Use `json:"objectives,omitempty"` to maintain backward compatibility so existing `themes.json` files without the field deserialize cleanly to an empty slice.

## Acceptance Criteria

- [ ] `Objective` struct in `internal/access/models.go` has an `Objectives []Objective` field with `json:"objectives,omitempty"` tag
- [ ] `ensureThemeIDs()` in `internal/access/plan_access.go` recurses to arbitrary depth when generating IDs
- [ ] Nested objective IDs follow the pattern `THEME-XX.OKR-XX.OKR-XX` (one `.OKR-XX` segment per nesting level)
- [ ] Key result IDs at any level follow the pattern `<parent-objective-id>.KR-XX`
- [ ] Existing `themes.json` files without the `objectives` field load without error (backward compat)
- [ ] ID generation is covered by unit tests

## Technical Details

- **Files**: `internal/access/models.go`, `internal/access/plan_access.go`
- Add `Objectives []Objective` field to the `Objective` struct
- Refactor `ensureThemeIDs()` to use a recursive helper that accepts a prefix and a slice of objectives
- Each recursive call appends `.OKR-XX` to the prefix for child objectives
- Key results at any level use the immediate parent objective's ID as prefix: `<objective-id>.KR-XX`
- The `omitempty` JSON tag ensures serialization omits the field when no children exist, keeping output clean

## Dependencies

- None. This is the foundational task for the epic.

## Effort Estimate

- **Size**: S
- **Hours**: 1

## Definition of Done

- `Objective` struct includes the `Objectives` field with correct JSON tag
- `ensureThemeIDs()` generates correct hierarchical IDs at arbitrary nesting depth
- Existing JSON without the `objectives` field deserializes without errors
- Unit tests verify recursive ID generation and backward compatibility
- All existing tests pass
