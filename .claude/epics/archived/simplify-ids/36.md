---
name: Update Go models and ID generation
status: done
created: 2026-02-07T14:30:24Z
updated: 2026-02-07T14:33:28Z
github: https://github.com/rknuus/Bearing/issues/36
depends_on: []
parallel: false
conflicts_with: [39]
---

# Task: Update Go models and ID generation

## Description
Update the Go data model structs and ID generation functions to use flat, globally unique IDs (`THEME-N`, `OBJ-N`, `KR-N`, `TASK-N`) with explicit `parentId` fields instead of hierarchical dot-notation IDs.

## Acceptance Criteria
- [ ] `Objective` struct has `ParentID string` field with `json:"parentId"` tag
- [ ] `KeyResult` struct has `ParentID string` field with `json:"parentId"` tag
- [ ] `generateThemeID()` produces `THEME-N` (unpadded)
- [ ] `ensureObjectiveIDs()` produces `OBJ-N` (globally unique, unpadded) and sets `ParentID`
- [ ] Key result IDs are `KR-N` (globally unique, unpadded) with `ParentID` set
- [ ] `generateTaskID()` produces `TASK-N` (unpadded, uppercase)
- [ ] Global counters scan all entities of a type across the entire tree

## Technical Details

**Files affected:**
- `internal/access/models.go` — add `ParentID` to `Objective` and `KeyResult`
- `internal/access/plan_access.go` — rewrite `generateThemeID()`, `ensureObjectiveIDs()`, `generateTaskID()`

**Key changes in `ensureObjectiveIDs()`:**
- Currently builds IDs like `parentID.OKR-%02d` — change to `OBJ-%d`
- Must scan all objectives globally (flatten the tree) to find max counter
- Must scan all key results globally to find max KR counter
- Set `ParentID` on each objective to the parent's ID (theme or parent objective)
- Set `ParentID` on each key result to the owning objective's ID

**Regex changes:**
- Theme: `^THEME-(\d+)$` (drop zero-pad expectation)
- Objective: `^OBJ-(\d+)$` (new prefix)
- Key Result: `^KR-(\d+)$` (same prefix, drop hierarchical)
- Task: `^TASK-(\d+)$` (uppercase, drop zero-pad)

## Effort Estimate
- Size: M
- Parallel: false — this is the foundation for all other tasks
