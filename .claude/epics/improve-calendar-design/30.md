---
name: Rewrite CalendarView grid layout with weekday alignment
status: open
created: 2026-02-06T14:56:53Z
updated: 2026-02-06T15:07:02Z
github: https://github.com/rknuus/Bearing/issues/30
depends_on: [29]
parallel: false
conflicts_with: [31, 32]
---

# Task: Rewrite CalendarView grid layout with weekday alignment

## Description

Replace the current 31-row × 13-column CSS grid in `CalendarView.svelte` with a weekday-aligned layout. The new grid has rows for weekdays (Mon–Sun) repeating for each calendar week, and columns for a weekday label + 12 months × 2 sub-columns (day number + text). This task covers the grid structure, date computation, headers, and sticky positioning — but not the detailed cell content rendering (that's Task #31).

## Acceptance Criteria

- [ ] Grid has rows = 7 weekdays × max_weeks (typically 6 for most years = 42 rows)
- [ ] Grid has columns = 1 (weekday label, ~50px) + 12 × 2 (day-number ~24px + text 1fr) = 25 columns
- [ ] Leftmost column shows weekday abbreviations (Mon, Tue, Wed, Thu, Fri, Sat, Sun) repeating per week
- [ ] Header row shows full month names (January–December), each spanning 2 sub-columns
- [ ] Each month's day 1 is placed at the correct weekday row (Monday-based: Mon=row 1 within each week group)
- [ ] January 1, 2026 aligns with Thursday; February 1, 2026 aligns with Sunday
- [ ] Empty cells appear where a month has no day for that row
- [ ] Weekday labels are sticky-left (visible during horizontal scroll)
- [ ] Month headers are sticky-top (visible during vertical scroll)
- [ ] Year navigation (prev/next/today) continues to work

## Technical Details

**New helper functions to add:**

```typescript
// Returns 0-6 (Mon=0, Tue=1, ... Sun=6) for the 1st of the given month
function getMonthStartWeekday(year: number, month: number): number {
  const jsDay = new Date(year, month, 1).getDay(); // 0=Sun, 1=Mon, ...
  return jsDay === 0 ? 6 : jsDay - 1; // Convert to Mon=0, Sun=6
}

// Returns number of days in a month
function getDaysInMonth(year: number, month: number): number {
  return new Date(year, month + 1, 0).getDate();
}

// Returns max calendar weeks any month spans in the given year
function getMaxWeeks(year: number): number {
  let max = 0;
  for (let m = 0; m < 12; m++) {
    const start = getMonthStartWeekday(year, m);
    const days = getDaysInMonth(year, m);
    const weeks = Math.ceil((start + days) / 7);
    if (weeks > max) max = weeks;
  }
  return max;
}

// Maps a day-of-month to its grid row (0-indexed)
function getDayRow(year: number, month: number, day: number): number {
  const start = getMonthStartWeekday(year, month);
  return start + day - 1; // 0-indexed row within the full grid
}
```

**CSS grid template:**
```css
.calendar-grid {
  display: grid;
  grid-template-columns: 50px repeat(12, 24px 1fr);
  grid-template-rows: auto repeat(42, 1.5rem); /* header + 42 day rows */
  gap: 1px;
  background: #e5e7eb;
}
```

**Rendering approach:**
- Iterate: for each month (0–11), for each day (1–daysInMonth), compute the grid row and place cells using `grid-row` and `grid-column` CSS properties
- Weekday labels: for each row (0–41), place label at column 1 with text = weekday name for `row % 7`

**Files to modify:**
- `frontend/src/views/CalendarView.svelte` — Script section (helper functions, remove old grid logic) and template section (new grid structure)

**Removals:**
- Old `isValidDate()` function (replaced by `getDaysInMonth` bounds check)
- Old `isWeekend()` function (replaced by weekday computation)
- Old `monthNames` short-name array (replaced by full names)
- `taskCounts` state and `getTaskCount` function (badges removed)
- Task loading from `loadData` (`GetTasks` call)

## Dependencies

- [ ] Task #29 — DayFocus `text` field must exist in types

## Effort Estimate

- Size: L
- Hours: 2.5
- Parallel: false
