---
name: Upstream archived-epic and task-closing fixes to fork
status: open
created: 2026-02-08T12:39:36Z
updated: 2026-02-08T12:55:04Z
github: https://github.com/rknuus/Bearing/issues/79
depends_on: []
parallel: true
conflicts_with: [77]
---

# Task: Upstream archived-epic and task-closing fixes to fork

## Description
Port two local fixes from Bearing's `.claude/ccpm/` to the `tmp/ccpm/` fork repository, making them ready for upstream contribution. These correspond to commit `d14cacf` (archived-epic exclusion + task-closing on merge).

## Acceptance Criteria
- [ ] `tmp/ccpm/ccpm/scripts/pm/status.sh` excludes archived epics from counts
- [ ] `tmp/ccpm/ccpm/commands/pm/epic-merge.md` includes task-closing loop before archiving
- [ ] Changes committed on a feature branch in `tmp/ccpm/`
- [ ] Fork commits are clean and self-contained

## Technical Details

**Fix 1: Exclude archived epics from status counts**

Compare Bearing's `.claude/ccpm/scripts/pm/status.sh` with `tmp/ccpm/ccpm/scripts/pm/status.sh`. The Bearing version filters out `archived/` paths. Apply the same filtering logic to the fork.

**Fix 2: Close task files on epic merge**

The Bearing version of `epic-merge.md` has a loop (from commit `d14cacf`) that marks task files as closed before archiving:
```bash
for task_file in .claude/epics/$ARGUMENTS/[0-9]*.md; do
  [ -f "$task_file" ] || continue
  sed -i '' 's/^status: *open/status: closed/' "$task_file"
done
```
Port this to the fork's `epic-merge.md` using the fork's path convention (`ccpm/epics/` instead of `.claude/epics/`).

**Files affected in `tmp/ccpm/`:**
- `ccpm/scripts/pm/status.sh`
- `ccpm/commands/pm/epic-merge.md`

**Branch strategy:**
- Create a feature branch in `tmp/ccpm/` (e.g. `fix/status-and-merge`)
- Make clean, atomic commits

## Dependencies
- [ ] None

## Effort Estimate
- Size: S
- Parallel: true

## Definition of Done
- [ ] Fixes ported to fork
- [ ] Committed on feature branch
- [ ] Changes verified by diff against Bearing versions
