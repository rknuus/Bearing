---
name: Update OKRView ancestor expansion logic
status: done
created: 2026-02-07T14:30:24Z
updated: 2026-02-07T14:33:28Z
github: https://github.com/rknuus/Bearing/issues/37
depends_on: [39]
parallel: true
conflicts_with: []
---

# Task: Update OKRView ancestor expansion logic

## Description
Replace the `highlightItemId.split('.')` logic in OKRView.svelte that expands ancestor nodes. Since IDs are no longer hierarchical, ancestor expansion must walk the theme tree using `parentId` fields.

## Acceptance Criteria
- [ ] Ancestor expansion works for highlighted items at any nesting depth
- [ ] No code references `split('.')` for ID parsing
- [ ] Breadcrumb navigation (if present) works with flat IDs
- [ ] No uncaught exceptions or infinite loops in the native app

## Technical Details

**Files affected:**
- `frontend/src/views/OKRView.svelte`

**Current code (lines ~292-303):**
```typescript
const parts = highlightItemId.split('.');
for (let i = 1; i <= parts.length; i++) {
    const ancestorId = parts.slice(0, i).join('.');
    expandedIds.add(ancestorId);
}
```

**New approach:**
- Write a helper that finds an entity by ID in the themes tree
- Walk up via `parentId` to collect all ancestor IDs
- Add each ancestor ID to `expandedIds`

## Effort Estimate
- Size: S
- Parallel: true â€” independent of tasks #40, #41, #35, #38
