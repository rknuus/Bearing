---
name: Implement SetObjectiveStatus and SetKeyResultStatus in PlanningManager
status: open
created: 2026-02-07T20:01:06Z
updated: 2026-02-07T20:02:00Z
github: https://github.com/rknuus/Bearing/issues/60
depends_on: [058]
parallel: false
conflicts_with: [062]
---

# Task: Implement SetObjectiveStatus and SetKeyResultStatus in PlanningManager

## Description
Add two new methods to `PlanningManager` and the `IPlanningManager` interface for setting the status of Objectives and Key Results. These methods validate status transitions and enforce the constraint that a parent Objective cannot be completed until all its direct children (child Objectives and Key Results) are completed or archived.

## Acceptance Criteria
- [ ] `SetObjectiveStatus(objectiveId, status string) error` added to interface and implementation
- [ ] `SetKeyResultStatus(keyResultId, status string) error` added to interface and implementation
- [ ] Transition validation: active→completed, completed→archived, completed→active (reopen), archived→active (reopen) are allowed
- [ ] Transition blocked: active→archived returns error
- [ ] Completing an Objective with active children returns descriptive error listing incomplete children
- [ ] Completing an Objective where all children are completed/archived succeeds
- [ ] Reopening sets status to active regardless of current state
- [ ] Invalid status values return error
- [ ] Tests cover: all valid transitions, blocked transitions, parent-child validation, empty/not-found IDs
- [ ] Data is persisted via `SaveTheme` after status change

## Technical Details
- Files: `internal/managers/planning_manager.go`, `internal/managers/planning_manager_test.go`
- Use existing `findObjectiveByID` and `findKeyResultParent` tree-walking helpers
- For parent completion check: iterate `obj.Objectives` and `obj.KeyResults`, check each Status (empty/"active" means active)
- Helper: `effectiveStatus(s string) string` — returns "active" if empty, otherwise s
- Follow existing method patterns (load themes, find entity, mutate, save theme)

## Dependencies
- [ ] Task 058 (Status field must exist on models)

## Effort Estimate
- Size: M
- Parallel: false (depends on 058, blocks 062)

## Definition of Done
- [ ] Code implemented
- [ ] Tests written and passing
- [ ] Linter passes
