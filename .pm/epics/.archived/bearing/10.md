---
name: Integration Testing
status: closed
created: 2026-01-31T14:36:57Z
updated: 2026-01-31T14:42:57Z
github: https://github.com/rknuus/Bearing/issues/10
depends_on: [9]
parallel: false
conflicts_with: []
---

# Task: Integration Testing

## Description
End-to-end validation of the linking mechanism across all three planning layers. Verify that colors propagate correctly, hierarchical IDs are consistent, breadcrumbs navigate accurately, and data persists through the full workflow.

## Acceptance Criteria
- [ ] E2E test: Create theme → assign to day → create task → verify color chain
- [ ] E2E test: Navigate via breadcrumb from task to theme
- [ ] E2E test: Move task between columns → verify git history shows file move
- [ ] E2E test: App restart → all data and navigation state restored
- [ ] E2E test: Delete theme → cascades appropriately (or warns user)
- [ ] Performance test: Calendar renders 365 days in < 100ms
- [ ] Performance test: View transitions < 100ms

## Technical Details

### Test Scenarios

#### Scenario 1: Full Linking Chain
```gherkin
Given the app is freshly started
When I create a Life Theme "Health" with color #22c55e
And I assign January 15th to theme "Health"
And I create a task "Go for a run" on January 15th
Then the theme card shows color #22c55e
And the January 15th calendar cell shows color #22c55e
And the task card shows color #22c55e
And the task's hierarchical ID starts with "THEME-01"
```

#### Scenario 2: Breadcrumb Navigation
```gherkin
Given a task exists with ID "THEME-01.TASK-001"
When I click on the task to select it
Then the breadcrumb shows "Health > Tasks > Go for a run"
When I click "Health" in the breadcrumb
Then I navigate to the OKR view
And the "Health" theme is highlighted/selected
```

#### Scenario 3: Git File Operations
```gherkin
Given a task exists in "todo" column
When I drag the task to "doing" column
Then the task file moves from tasks/THEME-01/todo/ to tasks/THEME-01/doing/
And git log shows a rename operation (not delete+add)
And the task data content is unchanged
```

#### Scenario 4: Data Persistence
```gherkin
Given I have created themes, days, and tasks
When I quit and restart the application
Then all themes are visible with correct colors
And all day assignments are preserved
And all tasks are in their correct columns
And the navigation state returns to last viewed position
```

### Test Infrastructure

#### Playwright E2E Setup
```typescript
// tests/e2e/linking.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Linking Mechanism', () => {
  test('color propagates from theme to task', async ({ page }) => {
    // Create theme
    await page.click('[data-testid="create-theme"]');
    await page.fill('[data-testid="theme-name"]', 'Health');
    await page.click('[data-testid="color-green"]');
    await page.click('[data-testid="save-theme"]');

    // Verify theme color
    const themeCard = page.locator('[data-testid="theme-Health"]');
    await expect(themeCard).toHaveCSS('--theme-color', '#22c55e');

    // Assign day to theme
    await page.click('[data-testid="nav-calendar"]');
    await page.click('[data-testid="day-2026-01-15"]');
    await page.selectOption('[data-testid="theme-select"]', 'Health');

    // Verify day color
    const dayCell = page.locator('[data-testid="day-2026-01-15"]');
    await expect(dayCell).toHaveCSS('--theme-color', '#22c55e');

    // Create task
    await page.click('[data-testid="nav-tasks"]');
    await page.click('[data-testid="create-task"]');
    await page.fill('[data-testid="task-title"]', 'Go for a run');
    await page.selectOption('[data-testid="task-day"]', '2026-01-15');
    await page.click('[data-testid="priority-important-urgent"]');
    await page.click('[data-testid="save-task"]');

    // Verify task color
    const taskCard = page.locator('[data-testid="task-Go-for-a-run"]');
    await expect(taskCard).toHaveCSS('--theme-color', '#22c55e');
  });
});
```

#### Git Operation Verification
```go
// internal/access/plan_access_test.go
func TestMoveTaskCreatesGitRename(t *testing.T) {
    // Setup: create task in todo
    // Action: move to doing
    // Verify: git log shows rename, not delete+add
    repo, _ := InitializeRepositoryWithConfig(...)
    history, _ := repo.GetFileHistory("tasks/THEME-01/doing/task-001.json", 1)
    // Parse commit to verify it's a rename operation
}
```

### Performance Benchmarks
```go
func BenchmarkCalendarRender(b *testing.B) {
    // Measure time to load and render 365 days
    // Target: < 100ms
}

func BenchmarkViewTransition(b *testing.B) {
    // Measure time to switch views
    // Target: < 100ms
}
```

## Dependencies
- [ ] Task #9: Navigation (full app navigation working)
- [ ] All views (#6, #7, #8) complete and integrated

## Effort Estimate
- Size: M
- Hours: 8-12
- Parallel: false (needs complete system)

## Definition of Done
- [ ] All E2E test scenarios pass
- [ ] Performance benchmarks meet targets
- [ ] Git file operations verified correct
- [ ] No data loss in persistence tests
- [ ] Test coverage documented in test report
