---
name: Update Wails App bindings and type conversions
status: closed
created: 2026-02-06T10:11:45Z
updated: 2026-02-06T10:17:09Z
github: https://github.com/rknuus/Bearing/issues/20
depends_on: [19]
parallel: false
conflicts_with: []
---

# Update Wails App bindings and type conversions

## Description

Update the Wails application layer to expose the new hierarchical objective model to the frontend. The duplicate `Objective` struct in `main.go` must gain the `Objectives []Objective` field. App method signatures need to match the simplified CRUD API from task #19. Type conversion logic between access-layer types and Wails types must handle recursive objectives. Finally, regenerate the TypeScript bindings so the frontend has accurate types.

## Acceptance Criteria

- [ ] Duplicate `Objective` struct in `main.go` includes `Objectives []Objective` field with appropriate JSON tag
- [ ] `App.CreateObjective(parentId, title)` signature matches the simplified API
- [ ] `App.UpdateObjective(objectiveId, title)` and `App.DeleteObjective(objectiveId)` signatures are updated
- [ ] Type conversion logic recursively converts nested objectives between access and Wails types
- [ ] `GetThemes` conversion recursively converts nested objectives in the response
- [ ] `wails generate module` runs successfully and regenerates TypeScript bindings
- [ ] TypeScript binding types include nested objectives
- [ ] Application starts without errors

## Technical Details

- **Files**: `main.go`, `frontend/wailsjs/go/main/App.d.ts`, `frontend/wailsjs/go/main/App.js`
- Add `Objectives []Objective` to the Wails-side `Objective` struct in `main.go`
- Update `App` method signatures:
  - `CreateObjective(parentId string, title string) error` â€” parentId can be a theme ID or objective ID
  - `UpdateObjective(objectiveId string, title string) error`
  - `DeleteObjective(objectiveId string) error`
  - KR methods remain: `CreateKeyResult(parentObjectiveId string, desc string) error`, `UpdateKeyResult(krId string, desc string) error`, `DeleteKeyResult(krId string) error`
- Add recursive conversion helper for `Objective` (access type to Wails type and vice versa)
- Update `GetThemes` to use the recursive converter when building the response
- Run `wails generate module` to regenerate `App.d.ts` and `App.js`

## Dependencies

- **#19**: Refactor PlanningManager CRUD for recursive tree-walking (must be completed first so the manager API exists to bind to)

## Effort Estimate

- **Size**: S
- **Hours**: 1.5

## Definition of Done

- Wails `Objective` struct mirrors the access-layer struct including nested objectives
- App method signatures match the simplified CRUD API
- Recursive type conversion handles arbitrary nesting depth
- TypeScript bindings are regenerated and include the `objectives` field on the `Objective` type
- Application compiles, starts, and serves themes with nested objectives without errors
- All existing tests pass
