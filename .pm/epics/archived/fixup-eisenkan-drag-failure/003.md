---
name: Add drag-and-drop test coverage
status: open
created: 2026-02-13T10:15:54Z
updated: 2026-02-13T10:15:54Z
github: [Will be updated when synced to GitHub]
depends_on: [001]
parallel: false
conflicts_with: [001]
---

# Task: Add drag-and-drop test coverage

## Description

Add unit tests for the fixed drag-and-drop functionality in `EisenKanView.test.ts`. The existing test file has mock setup for `MoveTask` but no tests that exercise the drag handlers. Cover cross-column drags (status changes), cross-section drags (priority changes), and rollback scenarios.

## Acceptance Criteria

- [ ] Test: dragging task between columns calls `MoveTask` with correct status
- [ ] Test: dragging task between priority sections calls `UpdateTask` with correct priority
- [ ] Test: successful move updates the task list
- [ ] Test: failed move (rule violation) triggers rollback and shows ErrorDialog
- [ ] Test: `ProcessPriorityPromotions` mock is called on mount
- [ ] All new tests pass with `make frontend-test`

## Technical Details

### Files Affected
- `frontend/src/views/EisenKanView.test.ts` — add new test cases

### Test Approach
- Use existing mock patterns from the test file (lines 52-78 set up `mockMoveTask`, `mockUpdateTask`, etc.)
- Simulate dnd events by calling the handler functions directly or dispatching `CustomEvent<DndEvent>` on dndzone containers
- For rollback tests: mock `MoveTask` to return `{ success: false, violations: [...] }` and verify state reverts
- For priority change tests: verify `UpdateTask` is called with the task's updated priority field

### Key Considerations
- `svelte-dnd-action` events have a specific shape (`DndEvent<TaskWithStatus>`) — construct test events matching this type
- Test both sectioned (Todo) and regular (Doing, Done) column drag paths
- Follow existing test patterns in the file for consistency

## Dependencies

- [ ] Task 001 must be complete (handlers need to exist before testing them)

## Effort Estimate
- Size: S
- Parallel: false (depends on 001)
